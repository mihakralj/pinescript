# HT_DCPHASE: Hilbert Transform - Dominant Cycle Phase

[Pine Script Implementation of HT_DCPHASE](https://github.com/mihakralj/pinescript/blob/main/indicators/cycles/ht_dcphase.pine)

## Overview and Purpose

The Hilbert Transform Dominant Cycle Phase (HT_DCPHASE) is an advanced cycle analysis indicator developed by John Ehlers that identifies the current phase position within the dominant market cycle. By applying Hilbert Transform mathematics to price data, this indicator extracts the phase angle of the dominant cycle, revealing where the market currently sits within its cyclical pattern. This information is invaluable for timing entries and exits, as it shows whether the cycle is in accumulation, markup, distribution, or markdown phases.

HT_DCPHASE works by computing the In-phase (I) and Quadrature (Q) components through Hilbert Transform analysis, then calculating the phase angle as the arctangent of Q/I. The result is a continuous phase measurement in radians ranging from -œÄ to œÄ, providing a precise indication of cycle position. This makes it particularly useful for identifying cycle turning points and anticipating trend changes before they become apparent in price action.

## Core Concepts

* **Phase Angle**: Measures position within cycle using arctangent of Q/I components; ranges from -œÄ to œÄ radians
* **Hilbert Transform**: Mathematical technique that creates 90-degree phase-shifted version of price for quadrature analysis
* **I and Q Components**: In-phase and Quadrature components represent cycle's position in two-dimensional phase space
* **Cycle Position**: Phase angle indicates whether market is in trough (-œÄ), peak (0), or transition phases (¬±œÄ/2)
* **Adaptive Bandwidth**: Uses dominant cycle period to adjust filter bandwidth for optimal detrending

## Common Settings and Parameters

| Parameter | Default | Function | When to Adjust |
|-----------|---------|----------|---------------|
| Source | hlc3 | Price data for analysis | Use close for simpler signals; hlc3 for smoother, more comprehensive cycle detection |

**Pro Tip:** HT_DCPHASE is most effective when used in conjunction with HT_DCPERIOD to understand both the cycle length and current position. Phase crossings through zero often correspond to significant trend changes. The indicator works best on instruments with clear cyclical behavior - sideways or ranging markets provide cleaner signals than strongly trending markets.

## Calculation and Mathematical Foundation

**Simplified explanation:**
HT_DCPHASE applies Hilbert Transform mathematics to extract the phase angle of the dominant market cycle, indicating the current position within the cycle.

**Technical formula:**

1. Smooth the price data:
   ```
   SmoothPrice = (4√óPrice + 3√óPrice[1] + 2√óPrice[2] + Price[3]) / 10
   ```

2. Detrend with adaptive bandwidth:
   ```
   Bandwidth = 0.075 √ó Period[1] + 0.54
   Detrender = Hilbert_FIR(SmoothPrice) √ó Bandwidth
   ```

3. Calculate Quadrature component (90¬∞ phase shift):
   ```
   Q1 = Hilbert_FIR(Detrender) √ó Bandwidth
   ```

4. Calculate In-phase component (delayed detrend):
   ```
   I1 = Detrender[3]
   ```

5. Apply Hilbert Transform to get jI and jQ:
   ```
   jI = Hilbert_FIR(I1) √ó Bandwidth
   jQ = Hilbert_FIR(Q1) √ó Bandwidth
   ```

6. Compute smoothed I2 and Q2:
   ```
   I2 = I1 - jQ
   Q2 = Q1 + jI
   I2 = 0.2√óI2 + 0.8√óI2[1]  (smooth)
   Q2 = 0.2√óQ2 + 0.8√óQ2[1]  (smooth)
   ```

7. Calculate phase angle:
   ```
   Phase = atan(Q2 / I2)
   ```

Where `Hilbert_FIR` is a finite impulse response filter with coefficients [0.0962, 0.5769, 0, -0.5769, -0.0962].

> üîç **Technical Note:** The phase calculation uses arctangent to convert the I and Q components from Cartesian to polar coordinates. The dominant cycle period (calculated from Re and Im) is used to adapt the filter bandwidth, ensuring the phase measurement tracks the actual market cycle rather than noise or shorter-term fluctuations.

## Interpretation Details

HT_DCPHASE provides cycle phase analysis through several interpretive lenses:

* **Phase Position:**
  - Phase ‚âà -œÄ: Cycle trough (potential buy zone)
  - Phase ‚âà -œÄ/2: Rising from trough (early uptrend)
  - Phase ‚âà 0: Cycle peak (potential sell zone)
  - Phase ‚âà œÄ/2: Declining from peak (early downtrend)

* **Phase Levels:**
  - Phase = 0: Cycle peak reached (distribution zone)
  - Phase = ¬±œÄ: Cycle trough reached (accumulation zone)
  - Phase transitions through these levels indicate cycle progression
  - Watch for price behavior at these phase extremes

* **Phase Velocity:**
  - Rapid phase changes indicate strong momentum
  - Slow phase progression suggests consolidation
  - Stalled phase can indicate cycle transition or mode change

* **Cycle Synchronization:**
  - Use with HT_DCPERIOD to confirm cycle consistency
  - Phase leads price by design, providing early signals
  - Most reliable in ranging or cyclical market conditions

* **Quadrant Analysis:**
  - Quadrant I (0 to œÄ/2): Early decline phase
  - Quadrant II (œÄ/2 to œÄ): Late decline phase
  - Quadrant III (-œÄ to -œÄ/2): Late rise phase
  - Quadrant IV (-œÄ/2 to 0): Early rise phase

## Limitations and Considerations

* **Trend Dependence:** Less reliable in strong trending markets; works best in cyclical or ranging conditions
* **Phase Wrapping:** Discontinuities at ¬±œÄ boundaries require careful interpretation of phase transitions
* **Lag Component:** Smoothing introduces slight lag; phase leads price but not instantaneously
* **Noise Sensitivity:** Can produce erratic signals in highly volatile or choppy markets without clear cycles
* **Cycle Assumption:** Assumes presence of dominant cycle; may give spurious signals in random walk conditions
* **Parameter Adaptation:** Uses previous period for bandwidth calculation; may lag during rapid cycle changes

## References

* Ehlers, J. F. (2004). "Cybernetic Analysis for Stocks and Futures." John Wiley & Sons.
* Ehlers, J. F. (2001). "Rocket Science for Traders: Digital Signal Processing Applications." John Wiley & Sons.
* Ehlers, J. F. (2013). "Cycle Analytics for Traders: Advanced Technical Trading Concepts." John Wiley & Sons.
